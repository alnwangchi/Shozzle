---
layout: '@layouts/BlogPostLayout.astro'
title: Unit Test (2)ï¼š Query Functions æ•´ç†
date: 2023-04-18
author: Jamie Chien
image: { src: '/images/post-1.jpg', alt: 'ç¯„ä¾‹' }
description: Unit Testçš„Query Functionsæ•´ç†ä»¥åŠTesting Playgroundä»‹ç´¹
draft: false
category: Unit Test
---

## å‰è¨€

**Query Functions**å¹«åŠ©æˆ‘å€‘æ‰¾åˆ°è¦æ¸¬è©¦çš„ elementsï¼Œä½†è¦æŠŠæ‰€æœ‰**Query Functions**è¨˜èµ·ä¾†ä¾†å°‹æ‰¾ elements å’Œ roles æ˜¯å¾ˆå›°é›£çš„ï¼Œæ‰€ä»¥å¯ä»¥å¦¥å–„åˆ©ç”¨å·¥å…·ã€‚ä»¥ä¸‹æœƒå…ˆä»‹ç´¹ä¸€ä¸‹å·¥å…·ï¼Œå¾Œé¢å†ä¾†ä»‹ç´¹é€™äº›**Query Functions**å€‘ã€‚

## ç›®éŒ„

- Testing Playground ä½¿ç”¨ä»‹ç´¹
- Query Functions ä»‹ç´¹
- Other Query Method

> ğŸ’¡ **ä»¥ä¸‹æœƒå…ˆä»‹ç´¹ Testing Playground å†ä»‹ç´¹ Query Functions å€‘**

> ğŸ’¡ **ä¸éœ€è¦å°‡é€™äº› Query Functions å…¨éƒ¨è¨˜èµ·ä¾†ï¼Œå¯ä»¥å¦¥å–„åˆ©ç”¨ Testing Playground å·¥å…·**

## Testing Playground ([Link](https://testing-playground.com/))

ä½¿ç”¨ Testing Playground çš„æ–¹æ³•æœ‰å¹¾å€‹:

### æ–¹æ³• 1

ç›´æ¥åˆ° Testing Playground çš„ç¶²ç«™ä½¿ç”¨

### æ–¹æ³• 2

åœ¨æ¸¬è©¦çš„å€å¡Šè£¡é¢åŠ ä¸Š`screen.logTestingPlaygroundURL()`å¯ä»¥åœ¨è·‘æ¸¬è©¦çš„æ™‚å€™ç”¢ç”Ÿä¸€ä¸²ç¶²å€ï¼Œé»æ“Šç¶²å€å°±å¯ä»¥å°åˆ°æœ‰ä½  render å‡ºä¾†çš„ element çš„ playground å»äº†~

> _Example_

```jsx
it('should render component correctly', () => {
  render(<Component />);

  screen.logTestingPlaygroundURL();

  // ...other logic

  // ...expect
});
```

æ¥è€…`npm run test {æª”å}`ä¾†è·‘æ¸¬è©¦ï¼Œç„¶å¾Œå°±æœƒå‡ºç¾å¦‚ä¸‹åœ–çš„ä¸€ä¸²ç¶²å€

![](https://i.imgur.com/jF7r51T.png)

é»æ“Šç¶²å€å°±æœƒç›´æ¥å°å‘ Testing Playground äº†~

## Query Functions

æ‰€æœ‰çš„ query functions éƒ½æ˜¯é€é`screen` object ä¾†ä½¿ç”¨çš„ï¼Œé€™äº› query functions æ°¸é éƒ½æ˜¯å¾ä»¥ä¸‹å¹¾å€‹åå­—é–‹é ­çš„: `getBy`ã€`getAllBy`ã€`queryBy`ã€`queryAllBy`ã€`findBy`ã€`findAllBy`

| Start of Function Name | Examples                             |
| ---------------------- | ------------------------------------ |
| `getBy...`             | getByRole, getByText                 |
| `getAllBy...`          | getAllByText, getAllByDisplayValue   |
| `queryBy...`           | queryByDisplayValue, queryByTitle    |
| `queryAllBy...`        | queryAllByTitle, queryAllByText      |
| `findBy...`            | findByRole, findByText               |
| `findAllBy...`         | findAllByText, findAllByDisplayValue |

> Compare

| Name            | 0 matches | 1 matches | >1 matches | Await? | Notes                   |
| --------------- | --------- | --------- | ---------- | ------ | ----------------------- |
| `getBy...`      | Throw     | Element   | Throw      | NO     |                         |
| `getAllBy...`   | Throw     | Element[] | Element[]  | NO     |                         |
| `queryBy...`    | null      | Element   | Throw      | NO     |                         |
| `queryAllBy...` | []        | Element[] | Element[]  | NO     |                         |
| `findBy...`     | Throw     | Element   | Throw      | YES    | é è¨­ 1 ç§’å…§å°‹æ‰¾ element |
| `findAllBy...`  | Throw     | Element[] | Element[]  | YES    | é è¨­ 1 ç§’å…§å°‹æ‰¾ element |

> ğŸ’¡`findBy`, `findAllBy` æ˜¯åœ¨ 1 ç§’å…§ä¸æ–· retry å°‹æ‰¾ elementï¼Œ1 ç§’å¾Œ `findBy`, `findAllBy` æ²’æœ‰æ‰¾åˆ° element æˆ– `findBy` æ‰¾åˆ°å¤šå€‹ elements æ™‚å°±æœƒ reject æ‰

> ğŸ’¡ `findBy` æ˜¯ `getBy*` èˆ‡ `[**waitFor**](https://testing-library.com/docs/dom-testing-library/api-async/#waitfor)` çš„çµåˆï¼Œä»–æ¥æ”¶ `waitFor` options ä¾†åšç‚ºæœ€å¾Œä¸€å€‹åƒæ•¸
> (i.e. `await screen.findByText('text', queryOptions, waitForOptions)` )

> Use Scenario

| Goal of test                                      | Use                 |
| ------------------------------------------------- | ------------------- |
| è­‰æ˜ element å­˜åœ¨                                 | getBy, getAllBy     |
| è­‰æ˜ element<span style="color:red">ä¸</span>å­˜åœ¨ | queryBy, queryAllBy |
| ç¢ºä¿ element æœ€çµ‚å­˜åœ¨                             | findBy, findAllBy   |

### API

> ğŸ’¡ ä»¥ä¸‹â€¦å¯ä»¥æ ¹æ“šéœ€æ±‚æ›¿æ›æˆé€™å¹¾å€‹é–‹é ­: `getBy`ã€`getAllBy`ã€`queryBy`ã€`queryAllBy`ã€`findBy`ã€`findAllBy`ï¼Œè©³ç´°ä½¿ç”¨è«‹åƒè€ƒä¸Šæ–¹

> ğŸ’¡ ä»¥ä¸‹åŸºæœ¬ä¸Šçš†ä»¥ `getBy` ä¾†åšç¯„ä¾‹

<details>
  <summary>
    <h3>...ByRole</h3>
  </summary>
  123
</details>

## Other Query Method ([Link](https://testing-library.com/docs/react-testing-library/api/))

## Unit Test ç³»åˆ—å…¶ä»–æ–‡ç« 
