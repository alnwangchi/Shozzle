---
layout: '@layouts/BlogPostLayout.astro'
title: Unit Test (3)：常見的 Matchers (Assertions) 整理
date: 2023-06-04
author: Jamie Chien
image: { src: 'https://i.imgur.com/jVSub4M.jpg', alt: '範例' }
description: 此文章整理了一些Jest以及React Testing Library中常見的斷言(Assertions)或稱作Matchers，利用這些斷言，可以來判斷測試是否符合預期
draft: false
category: Unit Test
---

import { Callout } from '@components/postComponents/callout';

## 前言

**Matchers**的機制可以讓我們利用各種方法來進行測試來判斷結果是否符合預期。這篇文章會列出一些常用的 matchers，並簡單地用一個範例來介紹，文章的最後也會簡單介紹如何客製化自己的 matchers~

## 目錄

- [Jest 中的 Matchers](#jest中的matchers-完整清單)
- [React Testing Library 中的 Matchers](#react-testing-library中的matchers-完整清單)
- [客製化 Matchers](#客製化matchers)

## Jest 中的 Matchers ([完整清單](https://jestjs.io/docs/expect#matchers))

{/* toBe */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBe() -> <a href="https://jestjs.io/docs/expect#tobevalue">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBe</code> 來比較<strong style="color:#DAA001">原始型別(Primitive)</strong>的值，使用他甚至比使用  <code>===</code> 還來的適合
    <Callout type="tip">
      只有<strong style="color:#DAA001">Primitive type</strong>才使用 <code>.toBe</code> ，其他type的請使用其他斷言 ( <code>.toEqual</code> ……)(<strong style="color:#DAA001">Primitive type</strong> 包含 Number, String, Boolean, Undefined, Null, Symbol)
    </Callout>
    <Callout type="warning">
      浮點數的比較不要使用 <code>.toBe</code> ，請使用 <code>.toBeCloseTo</code>
      ex: 在Javascript中，<code>0.2 + 0.1</code> 不嚴格(not-strictly)等於 <code>0.3</code>
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        const box = {
          football: 10,
          basketball: 12
        }

        it('should have 12', () => {
          expect(box.basketball).toBe(12);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveBeenCalled */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveBeenCalled() -> <a href="https://jestjs.io/docs/expect#tohavebeencalled">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveBeenCalled</code> 來確認mock function是否有被成功呼叫，他同時也有個別名: <code>.toBeCalled</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        function callFn(callback) {
          callback();
        }

        it('should call mock function', () => {
          const mockFn = jest.fn();
          callFn(mockFn);

          expect(mockFn).toHaveBeenCalled();
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveBeenCalledTimes */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveBeenCalledTimes(<code style="font-size: 16px">number</code>) -> <a href="https://jestjs.io/docs/expect#tohavebeencalledtimesnumber">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveBeenCalledTimes</code> 來確保mock function有被成功呼叫與傳入的 <code>number</code> 參數一樣的次數，他同時也有個別名: <code>.toBeCalledTimes(number)</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        function callFn(callback) {
          callback();
        }

        it('should call mock function one time', () => {
          const mockFn = jest.fn();
          callFn(mockFn);

          expect(mockFn).toHaveBeenCalledTimes(1);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveBeenCalledWith */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveBeenCalledWith(<code style="font-size: 16px">arg1, arg2, …</code>) -> <a href="https://jestjs.io/docs/expect#tohavebeencalledwitharg1-arg2-">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveBeenCalledWith</code> 來確保mock function呼叫時的參數與傳入的參數<code>(arg1, arg2)</code> 一致，他同時也有個別名: <code>.toBeCalledWith</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        function callFn(callback, args) {
          callback(args);
        }

        it('should call mock function with specific params', () => {
          const mockFn = jest.fn((num) => num);
          callFn(mockFn, 123);

          expect(mockFn).toHaveBeenCalledWith(123);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveReturned */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveReturned() -> <a href="https://jestjs.io/docs/expect#tohavereturned">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveReturned</code> 來確保mock function成功回傳至少一次(i.e. 沒有throw error)，他同時也有個別名: <code>.toReturn</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should return mock function', () => {
          const mockFn = jest.fn(() => true);
          mockFn();

          expect(mockFn).toHaveReturned();
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveReturnedTimes */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveReturnedTimes(<code style="font-size: 16px">number</code>) -> <a href="https://jestjs.io/docs/expect#tohavereturnedtimesnumber">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveReturnedTimes</code> 來確保mock function成功回傳數次(i.e. 沒有throw error)，而次數與傳入的參數 <code>number</code> 一致，他同時也有個別名: <code>.toReturnTimes(number)</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should return mock function twice', () => {
          const mockFn = jest.fn(() => true);
          mockFn();
          mockFn();

          expect(mockFn).toHaveReturnedTimes(2);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveReturnedWith */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveReturnedWith(<code style="font-size: 16px">value</code>) -> <a href="https://jestjs.io/docs/expect#tohavereturnedwithvalue">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveReturnedWith</code> 來確保mock function回傳的值與傳入的參數 <code>value</code> 一致，他同時也有個別名: <code>.toReturnWith(value)</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should return mock function twice', () => {
          const mockFn = jest.fn(() => 'hello world');
          mockFn();

          expect(mockFn).toHaveReturnedWith('hello world');
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveLength */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveLength(<code style="font-size: 16px">number</code>) ->{' '}
      <a href="https://jestjs.io/docs/expect#tohavelengthnumber">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveLength</code> 來確保該object擁有 <code>.length</code> 屬性，並且與傳入的參數{' '}
    <code>number</code> 一致
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript expect([1, 2, 3]).toHaveLength(3); expect('abc').toHaveLength(3);
        expect('').not.toHaveLength(5); ```
      </div>
    </details>
  </div>
</details>

{/* toHaveProperty */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveProperty(<code style="font-size: 16px">keyPath, value?</code>) -> <a href="https://jestjs.io/docs/expect#tohavepropertykeypath-value">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveProperty</code> 來確保提供的參數 <code>keyPath</code> 是否有存在object中，而第二個參數 <code>value</code> 則是選填，可以用來比對這個keyPath的值是否一致。
    <Callout type="tip">
      第二個參數 <code>value</code> 比對的方式相當於 <code>toEqual</code> 
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        const box = {
          football: 10,
          basketball: 12,
          toy: [
            'LEGO',
            'doll'
          ]
        }

        it('should have property', () => {
          expect(box).toHaveProperty('football');
          expect(box).toHaveProperty('basketball', 12);
          expect(box).not.toHaveProperty('baseball');

          expect(box).toHaveProperty('toy', ['LEGO', 'doll']);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeCloseTo */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeCloseTo(<code style="font-size: 16px">number, numberDigits?</code>) -> <a href="https://jestjs.io/docs/expect#tobeclosetonumber-numdigits">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeCloseTo</code> 來比較大致相等的浮點數數字 (floating point numbers)
    第二個參數 <code>numberDigits</code> 是用來限制要檢查的位數 (小數點後的位數)，預設為 <code>2</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should have 12', () => {
          expect(0.2 + 0.1).toBeCloseTo(0.3, 5);
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toBeDefined */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeDefined() -> <a href="https://jestjs.io/docs/expect#tobedefined">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeDefined</code> 來檢查變數，確保他<strong style="color:#DAA001">不是</strong> <code>undefined</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        let definedValue = 'Hi';
        let undefinedValue;

        it('should check variable', () => {
          expect(definedValue).toBeDefined();
          expect(undefinedValue).not.toBeDefined();
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeFalsy */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeFalsy() -> <a href="https://jestjs.io/docs/expect#tobefalsy">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeFalsy</code> 來確認是否為<code>falsy</code> value
    <Callout type="tip">
      在JavaScript中，總共有六個falsy value，分別是: <code>false</code>、<code>0</code>、<code>""</code>、<code>null</code>、<code>undefined</code>、<code>NaN</code>
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be falsy', () => {
          const falsyValue = false;

          expect(falsyValue).toBeFalsy();
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeTruthy */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeTruthy() -> <a href="https://jestjs.io/docs/expect#tobetruthy">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeTruthy</code> 來確認是否為<code>truthy</code> value，除了下面提到的六個falsy value外，其餘的值都會被視為truthy value
    <Callout type="tip">
      在JavaScript中，總共有六個falsy value，分別是: <code>false</code>、<code>0</code>、<code>""</code>、<code>null</code>、<code>undefined</code>、<code>NaN</code>
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be truthy', () => {
          const truthyValue = true;

          expect(truthyValue).toBeTruthy();
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeGreaterThan */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeGreaterThan(<code style="font-size: 16px">number | bigint</code>) -> <a href="https://jestjs.io/docs/expect#tobegreaterthannumber--bigint">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeGreaterThan</code> 來確認 <code>收到的值</code> <strong style="color:#DAA001">&gt;</strong> <code>期望的值</code> 
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be greater than 10', () => {
          const receivedValue = 11;

          expect(receivedValue).toBeGreaterThan(10);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeGreaterThanOrEqual */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeGreaterThanOrEqual(<code style="font-size: 16px">number | bigint</code>) -> <a href="https://jestjs.io/docs/expect#tobegreaterthanorequalnumber--bigint">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeGreaterThanOrEqual</code> 來確認 <code>收到的值</code> <strong style="color:#DAA001">&gt;=</strong> <code>期望的值</code> 
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be greater than or equal 10', () => {
          const receivedValue = 10;

          expect(receivedValue).toBeGreaterThanOrEqual(10);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeLessThan */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeLessThan(<code style="font-size: 16px">number | bigint</code>) -> <a href="https://jestjs.io/docs/expect#tobelessthannumber--bigint">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeLessThan</code> 來確認 <code>收到的值</code> <strong style="color:#DAA001">&lt;</strong> <code>期望的值</code> 
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be less than 10', () => {
          const receivedValue = 9;

          expect(receivedValue).toBeLessThan(10);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeLessThanOrEqual */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeLessThanOrEqual(<code style="font-size: 16px">number | bigint</code>) -> <a href="https://jestjs.io/docs/expect#tobelessthanorequalnumber--bigint">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toLessThanOrEqual</code> 來確認 <code>收到的值</code> <strong style="color:#DAA001">&lt;=</strong> <code>期望的值</code> 
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be less than or equal 10', () => {
          const receivedValue = 10;

          expect(receivedValue).toBeLessThanOrEqual(10);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeInstanceOf */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeInstanceOf(<code style="font-size: 16px">Class</code>) -> <a href="https://jestjs.io/docs/expect#tobeinstanceofclass">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeInstanceOf</code> 來確認object是某個class的實例(instance)
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        class A {}

        it('should be instance of class A', () => {
          expect(new A()).toBeInstanceOf(A);
          expect(() => {}).toBeInstanceOf(Function);
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeNull */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeNull() -> <a href="https://jestjs.io/docs/expect#tobenull">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeNull</code> 來確認是否為<code>null</code>，他與 <code>toBe(null)</code>相同，但使用 <code>.toBeNull</code> 的error messages更好
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be null', () => {
          const nullValue = null;
          expect(nullValue).toBeNull();
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toBeUndefined */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeUndefined() -> <a href="https://jestjs.io/docs/expect#tobeundefined">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeUndefined</code> 來確認是否為 <code>undefined</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be undefined', () => {
          let undefinedValue;
          expect(undefinedValue).toBeUndefined();
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toBeNaN */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeNaN() -> <a href="https://jestjs.io/docs/expect#tobenan">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeNaN</code> 來確認是否為 <code>NaN</code>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should check NaN', () => {
          expect(NaN).toBeNaN();
          expect(1).not.toBeNaN();
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toContain */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toContain(<code style="font-size: 16px">item</code>) -> <a href="https://jestjs.io/docs/expect#tocontainitem">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toContain</code> 來確認某個item是否在array裡面，或是確認某個string item是否為string的substring，此外，也可以用在sets, node lists, HTML collections中
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should contain item', () => {
          const item = 'hi'
          expect(['hi', 'hello']).toContain(item);
          expect('hi ~ everyone').toContain(item);
          expect(new Set(['hi'])).toContain(item);
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toEqual */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toEqual(<code style="font-size: 16px">value</code>) -> <a href="https://jestjs.io/docs/expect#toequalvalue">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toEqual</code> 來確認object是否與期望的一致 (deep equality)
    <Callout type="tip">
      當要比較<strong style="color:#DAA001">Object type</strong>時，必須使用 <code>.toEqual</code> 
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be equal', () => {
          const obj1 = { name: 'Jamie', info: { age: 24 } }
          const obj2 = { name: 'Jamie', info: { age: 24 } }
          
          expect(obj1).toEqual(obj2);
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toMatch */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toMatch(<code style="font-size: 16px">regexp | string</code>) -> <a href="https://jestjs.io/docs/expect#tomatchregexp--string">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toMatch</code> 來確認string符合正則的規則
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should be match', () => {
          const phone = '0912345678'
          const validator = /^(09)[0-9]{8}$/
          
          expect(phone).toMatch(validator);
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toThrow */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toThrow(<code style="font-size: 16px">error?</code>) -> <a href="https://jestjs.io/docs/expect#tothrowerror">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toThrow</code> 來確認function有沒有throw
    <Callout type="tip">
      要把code用function包起來，不然error不會被抓到，間接導致測試失敗
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        it('should throw', () => {
          function throwFunc() {
            throw new Error();
          }
          
          expect(() => throwFunc()).toThrow();
        })
        ```
      </div>
    </details>
  </div>
</details>

## React Testing Library 中的 Matchers ([完整清單](https://github.com/testing-library/jest-dom#custom-matchers))

{/* toBeDisabled */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeDisabled() -> <a href="https://github.com/testing-library/jest-dom#tobedisabled">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeDisabled</code> 來確認element有沒有被disabled
    <Callout type="tip">
      以下的elements是可以被disabled的: <code>button</code>、<code>input</code>、<code>select</code>、<code>textarea</code>、<code>optgroup</code>、<code>option</code>、<code>fieldset</code> 和客製化的elements
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <button data-testid="button" type="submit" disabled>submit</button>
        ```
        ```javascript
        it('should be disabled', () => {
          expect(getByTestId('button').toBeDisabled();
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toBeEmptyDOMElement */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeEmptyDOMElement() -> <a href="https://github.com/testing-library/jest-dom#tobeemptydomelement">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeEmptyDOMElement</code> 來確認element有沒有不可視(not visible)的內容
    <Callout type="warning">
      這個函式會忽略註解，但如果包含空格(white-space)的話，會導致測試失敗
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <span data-testid="not-empty"><span data-testid="empty"></span></span>
        ```
        ```javascript
        it('should be empty | not empty', () => {
          expect(getByTestId('empty')).toBeEmptyDOMElement()
          expect(getByTestId('not-empty')).not.toBeEmptyDOMElement()
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toBeInTheDocument */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeInTheDocument() -> <a href="https://github.com/testing-library/jest-dom#tobeinthedocument">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeInTheDocument</code> 來確認element是否有呈現在document中
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <span data-testid="html-element"><span>Html Element</span></span>
        ```
        ```javascript
        it('should be (not) in the document', () => {
          expect(getByTestId(document.documentElement, 'html-element')).toBeInTheDocument()
          expect(getByTestId(document.documentElement, 'not-exist')).not.toBeInTheDocument()
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toBeRequired */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeRequired() -> <a href="https://github.com/testing-library/jest-dom#toberequired">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeRequired</code> 來確認form element目前是否為 <code>required</code>
    <Callout type="tip">
      element required當他有以下attribute: <code>required</code>、<code>aria-required="true"</code>
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <input data-testid="input" required />
        <select data-testid="select"></select>
        ```
        ```javascript
        it('should be (not) required', () => {
          expect(getByTestId('input')).toBeRequired()
          expect(getByTestId('select')).not.toBeRequired()
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toBeVisible */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeVisible() -> <a href="https://github.com/testing-library/jest-dom#tobevisible">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toBeVisible</code> 來確認element目前是否可以被user看到
    <Callout type="tip">
      element 要被看到必須要符合所有以下條件:
      - 呈現在document中
      - css 的屬性 <code>display</code> 沒有設定成 <code>none</code>
      - css 的屬性 <code>visibility</code> 沒有設定成 <code>hidden</code> 或 <code>collapse</code>
      - css 的屬性 <code>opacity</code> 沒有設定成 <code>0</code>
      - 此element的parent也是visible的狀態 (包含所有parent直到DOM tree的頂點)
      - 此element沒有 <code>hidden</code> 的attribute
      - 如果 <code>&lt;details /&gt;</code>，那他要有 <code>open</code> 的attribute
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <div data-testid="display-none" style="display: none">Display None Example</div>
        <div data-testid="visibility-el">Hi</div>
        ```
        ```javascript
        it('should be (not) visible', () => {
          expect(getByTestId('display-none')).not.toBeVisible()
          expect(getByTestId('visibility-el')).toBeVisible()
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toContainElement */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toContainElement(
      <code style="font-size: 16px">element: HTMLElement | SVGElement | null</code>) ->{' '}
      <a href="https://github.com/testing-library/jest-dom#tocontainelement">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toContainElement</code> 來確認element是否有包含其他element作為子孫
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <span data-testid="ancestor">
          <span data-testid="descendant"></span>
        </span>
        ``` ```javascript it('should contain element', () =>{' '}
        {expect(getByTestId('ancestor')).toContainElement(getByTestId('descendant'))}) ```
      </div>
    </details>
  </div>
</details>

{/* toContainHTML */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toContainHTML(<code style="font-size: 16px">htmlText: string</code>) ->{' '}
      <a href="https://github.com/testing-library/jest-dom#tocontainhtml">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toContainHTML</code> 來確認element是否有包含其他html element作為子孫，且此html
    element使用string來做表示
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <span data-testid="parent">
          <span data-testid="child"></span>
        </span>
        ``` ```javascript it('should contain element', () =>{' '}
        {expect(getByTestId('parent')).toContainHTML('<span data-testid="child"></span>')}) ```
      </div>
    </details>
  </div>
</details>

{/* toHaveAttribute */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveAttribute(<code style="font-size: 16px">attr: string, value?: any</code>) -> <a href="https://github.com/testing-library/jest-dom#tohaveattribute">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveAttribute</code> 來確認element是否有該attribute，也可以加上value來確認這個attribute是否有該value
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <button data-testid="ok-button" type="submit" disabled>ok</button>
        ```
        ```javascript
        it('should have attribute', () => {
          const button = getByTestId('ok-button')

          expect(button).toHaveAttribute('disabled')
          expect(button).toHaveAttribute('type', 'submit')
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveClass */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveClass(<code style="font-size: 16px">…classNames: string[], options?: \{exact: boolean\}</code>) -> <a href="https://github.com/testing-library/jest-dom#tohaveclass">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveClass</code> 來確認element是否有該class，必須至少給一個class，否則此element會被視為沒有任何classes
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <button data-testid="delete-button" class="btn extra btn-danger">
          Delete item
        </button>
        <button data-testid="no-classes">No Classes</button>
        ```
        ```javascript
        it('should (not) have class', () => {
          const deleteButton = getByTestId('delete-button')
          const noClasses = getByTestId('no-classes')

          expect(deleteButton).toHaveClass('extra')
          expect(deleteButton).toHaveClass('btn-danger btn')
          expect(noClasses).not.toHaveClass()
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveFocus */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveFocus() -> <a href="https://github.com/testing-library/jest-dom#tohavefocus">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveFocus</code> 來確認element是否有被focus
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <div><input type="text" data-testid="element-to-focus" /></div>
        ```
        ```javascript
        it('should (not) have focus', () => {
          const input = getByTestId('element-to-focus')

          input.focus()
          expect(input).toHaveFocus()

          input.blur()
          expect(input).not.toHaveFocus()
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveStyle */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveStyle(<code style="font-size: 16px">css: string | object</code>) -> <a href="https://github.com/testing-library/jest-dom#tohavestyle">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveStyle</code> 來確認element是否有specific css屬性和value
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <button
          data-testid="delete-button"
          style="display: none"
        >
          Delete item
        </button>
        ```
        ```javascript
        it('should have style', () => {
          const button = getByTestId('delete-button')

          expect(button).toHaveStyle('display: none')
          expect(button).toHaveStyle({display: 'none'})
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveTextContent */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveTextContent(<code style="font-size: 16px">text: string | RegExp, options?: \{ normalizeWhitespace: boolean\}</code>) -> <a href="https://github.com/testing-library/jest-dom#tohavetextcontent">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveTextContent</code> 來確認element是否有具體的文字內容
    <Callout type="tip">
      若要忽略大小寫問題，可以使用 <code>RegExp</code> 並使用 <code>/i</code>
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <span data-testid="text-content">Text Content</span>
        ```
        ```javascript
        it('should have style', () => {
          const el = getByTestId('text-content')

          expect(el).toHaveTextContent('Content')
          expect(el).toHaveTextContent(/^Text Content$/)  // to match whole content
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toHaveValue */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveValue(<code style="font-size: 16px">value: string | string[] | number</code>) -> <a href="https://github.com/testing-library/jest-dom#tohavevalue">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveTextValue</code> 來確認form element是否有具體的值
    <Callout type="tip">
      可以用來確認以下form element的value: <code>&lt;input&gt;</code>、<code>&lt;select&gt;</code>、<code>&lt;textarea&gt;</code>
      (但不包括 <code>&lt;input type="checkbox"&gt;</code> 和 <code>&lt;input type="radio"&gt;</code> ）
    </Callout>
    <Callout type="tip">
      若要確認其他form element的值，可以使用 <code>toHaveFormValues</code> 這個斷言
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <input type="text" value="text" data-testid="input-text" />
        <input type="number" value="5" data-testid="input-number" />
        <input type="text" data-testid="input-empty" />
        <select multiple data-testid="select-number">
          <option value="first">First Value</option>
          <option value="second" selected>Second Value</option>
          <option value="third" selected>Third Value</option>
        </select>
        ```
        ```javascript
        it('should have value', () => {
          const textInput = getByTestId('input-text')
          const numberInput = getByTestId('input-number')
          const emptyInput = getByTestId('input-empty')
          const selectInput = getByTestId('select-number')
          
          expect(textInput).toHaveValue('text')
          expect(numberInput).toHaveValue(5)
          expect(emptyInput).not.toHaveValue()
          expect(selectInput).toHaveValue(['second', 'third'])
        })
        ```
      </div>
    </details>
  </div>
</details>

{/* toHaveDisplayValue */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toHaveDisplayValue(<code style="font-size: 16px">value: string | RegExp | (string | RegExp)[]</code>) -> <a href="https://github.com/testing-library/jest-dom#tohavedisplayvalue">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveTextValue</code> 來確認form element是否有具體的值
    <Callout type="tip">
      可以用來確認以下form element的value: <code>&lt;input&gt;</code>、<code>&lt;select&gt;</code>、<code>&lt;textarea&gt;</code>
      (但不包括 <code>&lt;input type="checkbox"&gt;</code> 和 <code>&lt;input type="radio"&gt;</code> ）
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <label for="input-example">First name</label>
        <input type="text" id="input-example" value="Luca" />

        <label for="textarea-example">Description</label>
        <textarea id="textarea-example">An example description here.</textarea>
        ```
        ```javascript
        it('should have display value', () => {
          const input = getByLabelText('First name')
          const textarea = getByLabelText('Description')

          expect(input).toHaveDisplayValue('Luca')
          expect(input).toHaveDisplayValue(/Luc/)
          expect(textarea).toHaveDisplayValue('An example description here.')
          expect(textarea).toHaveDisplayValue(/example/)
        })
        ```
      </div>
    </details>

  </div>
</details>

{/* toBeChecked */}

<details>
  <summary>
    <h3 style="margin: 0">
      ...toBeChecked() -> <a href="https://github.com/testing-library/jest-dom#tobechecked">Link</a>
    </h3>
  </summary>
  <div style="padding-left: 14px">
    透過 <code>.toHaveChecked</code> 來確認element是否為 <code>checked</code>
    <Callout type="tip">
      可以用來確認以下element: 
        - <code>input</code> 的型態為 <code>checkbox</code> 或 <code>radio</code>
        - <code>role</code> 為 <code>checkbox</code>、<code>radio</code> 或 <code>switch</code>
        - <code>aria-checked</code> 的屬性(attribute)為 <code>true</code> 或 <code>false</code>
    </Callout>
    <details>
      <summary style="font-style: italic; font-weight: 600">Example</summary>
      <div style="padding-left: 14px">
        ```javascript
        <input type="checkbox" checked data-testid="input-checkbox-checked" />
        <input type="checkbox" data-testid="input-checkbox-unchecked" />
        <div role="checkbox" aria-checked="true" data-testid="aria-checkbox-checked" />
        <div
          role="checkbox"
          aria-checked="false"
          data-testid="aria-checkbox-unchecked"
        />
        <input type="radio" checked value="foo" data-testid="input-radio-checked" />
        <input type="radio" value="foo" data-testid="input-radio-unchecked" />
        <div role="radio" aria-checked="true" data-testid="aria-radio-checked" />
        <div role="radio" aria-checked="false" data-testid="aria-radio-unchecked" />
        <div role="switch" aria-checked="true" data-testid="aria-switch-checked" />
        <div role="switch" aria-checked="false" data-testid="aria-switch-unchecked" />
        ```
        ```javascript
        it('should have checked or unchecked', () => {
          const inputCheckboxChecked = getByTestId('input-checkbox-checked')
          const inputCheckboxUnchecked = getByTestId('input-checkbox-unchecked')
          const ariaCheckboxChecked = getByTestId('aria-checkbox-checked')
          const ariaCheckboxUnchecked = getByTestId('aria-checkbox-unchecked')
          expect(inputCheckboxChecked).toBeChecked()
          expect(inputCheckboxUnchecked).not.toBeChecked()
          expect(ariaCheckboxChecked).toBeChecked()
          expect(ariaCheckboxUnchecked).not.toBeChecked()
          
          const inputRadioChecked = getByTestId('input-radio-checked')
          const inputRadioUnchecked = getByTestId('input-radio-unchecked')
          const ariaRadioChecked = getByTestId('aria-radio-checked')
          const ariaRadioUnchecked = getByTestId('aria-radio-unchecked')
          expect(inputRadioChecked).toBeChecked()
          expect(inputRadioUnchecked).not.toBeChecked()
          expect(ariaRadioChecked).toBeChecked()
          expect(ariaRadioUnchecked).not.toBeChecked()
          
          const ariaSwitchChecked = getByTestId('aria-switch-checked')
          const ariaSwitchUnchecked = getByTestId('aria-switch-unchecked')
          expect(ariaSwitchChecked).toBeChecked()
          expect(ariaSwitchUnchecked).not.toBeChecked()
        })
        ```
      </div>
    </details>
  </div>
</details>

## 客製化 Matchers

透過 <code>expect.extend</code> ，我們可以自己實作 matchers 來用在 unit test 上，詳細使用方式可以參考[官方 docs](https://jestjs.io/docs/expect#expectextendmatchers)，以下用一個例子來簡述:

> Example

這個範例中，我們透過創建一個 <code>toContainRole</code> 來自己創建一個客製化的 matcher，避免因為重複寫同樣的程式碼而變成碼農

<span style="font-style: italic">DataForm.js</span>
```jsx
  function ButtonComponent() {
    return (
      <div>
        <button>Submit</button>
        <button>Cancel</button>
      </div>
    )
  }
```

<span style="font-style: italic">DataForm.test.js</span>
```javascript
  function toContainRole(container, role, quantity = 1) {
    const elements = within(container).queryAllByRole(role);

    if (elements.length === quantity) {
      return {
        pass: true
      }
    }

    return {
      pass: false,
      message: () => `Expected to find ${quantity} ${role} elements.`
    }

}

// 透過 expect.extend 來使用 custom matchers
expect.extend({ toContainRole })

it('should display two buttons', () => {
render(<DataForm />);

    const form = screen.getByRole('form');

    expect(form).toContainRole('button', 2);

})

```

## Unit Test 系列其他文章

<a href="./unittest">Unit Test (1)：介紹單元測試</a>
<br />
<a href="./unittest-queryfunctions">Unit Test (2)：Query Functions 整理</a>

